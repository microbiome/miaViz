% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotCCA.R
\name{plotCCA}
\alias{plotCCA}
\alias{plotRDA}
\alias{plotCCA,SingleCellExperiment-method}
\alias{plotCCA,matrix-method}
\alias{plotRDA,SingleCellExperiment-method}
\alias{plotRDA,matrix-method}
\title{Plot RDA or CCA object}
\usage{
plotCCA(object, dimred, ...)

\S4method{plotCCA}{SingleCellExperiment}(object, dimred, ...)

\S4method{plotCCA}{matrix}(object, dimred, ...)

plotRDA(
  object,
  dimred,
  ellipse_fill = TRUE,
  ellipse_alpha = 0.2,
  ellipse_size = 0.1,
  ellipse_linetype = 1,
  vec_size = 0.5,
  vec_color = vec_colour,
  vec_colour = "black",
  vec_linetype = 1,
  arrow_size = 0.25,
  label_color = label_colour,
  label_colour = "black",
  label_size = 4,
  vec_text = TRUE,
  repel_labels = TRUE,
  ...
)

\S4method{plotRDA}{SingleCellExperiment}(
  object,
  dimred,
  ellipse_fill = TRUE,
  ellipse_alpha = 0.2,
  ellipse_size = 0.1,
  ellipse_linetype = 1,
  vec_size = 0.5,
  vec_color = vec_colour,
  vec_colour = "black",
  vec_linetype = 1,
  arrow_size = 0.25,
  label_color = label_colour,
  label_colour = "black",
  label_size = 4,
  vec_text = TRUE,
  repel_labels = TRUE,
  ...
)

\S4method{plotRDA}{matrix}(
  object,
  dimred,
  ellipse_fill = TRUE,
  ellipse_alpha = 0.2,
  ellipse_size = 0.1,
  ellipse_linetype = 1,
  vec_size = 0.5,
  vec_color = vec_colour,
  vec_colour = "black",
  vec_linetype = 1,
  arrow_size = 0.25,
  label_color = label_colour,
  label_colour = "black",
  label_size = 4,
  vec_text = TRUE,
  repel_labels = TRUE,
  ...
)
}
\arguments{
\item{object}{a
\code{\link[TreeSummarizedExperiment:TreeSummarizedExperiment-constructor]{TreeSummarizedExperiment}}
or a matrix of weights. The latter is returned as output from \code{\link[mia:runCCA]{calculateRDA}}.}

\item{dimred}{A string or integer scalar indicating the reduced dimension to
plot. This is the output of \code{\link[mia:runCCA]{runRDA}} and resides in
\code{reducedDim(tse, dimred)}.}

\item{...}{additional parameters for plotting, inherited from
\code{\link[scater:plotReducedDim]{plotReducedDim}},
\code{\link[ggplot2:geom_label]{geom_label}} and
\code{\link[ggrepel:geom_label_repel]{geom_label_repel}}.}

\item{ellipse_fill}{TRUE or FALSE, should ellipses be opacity filled.
(default: \code{ellipse_fill = TRUE})}

\item{ellipse_alpha}{Number between 0 and 1 to adjust the opacity of ellipses.
(default: \code{ellipse_alpha = 0.2})}

\item{ellipse_size}{Number specifying the size of ellipses.
(default: \code{ellipse_size = 0.1})}

\item{ellipse_linetype}{Discrete number specifying the style of ellipses
(default: \code{ellipse_linetype = 1})}

\item{vec_size}{Number specifying the size of vectors.
(default: \code{vec_size = 0.5})}

\item{vec_color}{Alias for \code{vec_colour}.}

\item{vec_colour}{String specifying the colour of vectors.
(default: \code{vec_color = "black"})}

\item{vec_linetype}{Discrete number specifying the style of vector lines.
(default: \code{vec_linetype = 1})}

\item{arrow_size}{Number specifying the size of arrows.
(defaults: \code{arrow_size = 0.25})}

\item{label_color}{Alias for \code{label_colour}.}

\item{label_colour}{String specifying the colour of text and labels.
(default: \code{label_color = "black"})}

\item{label_size}{Number specifying the size of text and labels.
(default: \code{label_size = 4})}

\item{vec_text}{TRUE or FALSE, should text instead of labels be used to label vectors.
(default: \code{vec_text = TRUE})}

\item{repel_labels}{TRUE or FALSE, should labels be repelled
(default: \code{repel_labels = TRUE})}
}
\value{
A \code{ggplot2} object
}
\description{
\code{plotRDA} and \code{plotCCA} create an RDA/CCA plot starting from the
output of \code{\link[mia:runCCA]{CCA and RDA}} functions, two common methods
for supervised ordination of microbiome data.
}
\details{
\code{plotRDA} and \code{plotCCA} create an RDA/CCA plot starting from the
output of \code{\link[mia:runCCA]{CCA and RDA}} functions, two common methods
for supervised ordination of microbiome data. Both
\code{\link[TreeSummarizedExperiment:TreeSummarizedExperiment-constructor]{TreeSummarizedExperiment}}
and matrix objects are supported as input. When the input is a
TreeSummarizedExperiment, this should contain the output of runRDA
in the reducedDim slot and the argument \code{dimred} needs to be defined.
When the input is an matrix, this should be returned as output from
calculateRDA and the argument \code{dimred} needs not be defined. However,
the first method is recommended because it provides the option to adjust
aesthetics to the colData variables through the arguments inherited from
\code{\link[scater:plotReducedDim]{plotReducedDim}}.
}
\examples{
# Load dataset
library(miaViz)
data("enterotype", package = "mia")
tse <- enterotype
 
# Run RDA and store results into TreeSE
tse <- runRDA(tse,
              formula = assay ~ ClinicalStatus + Gender + Age,
              FUN = vegan::vegdist,
              distance = "bray")
               
# Create RDA plot coloured by variable
plotRDA(tse, "RDA",
        colour_by = "ClinicalStatus")
 
# Create RDA plot with empty ellipses
plotRDA(tse, "RDA",
        colour_by = "ClinicalStatus",
        ellipse_fill = FALSE)
 
# Create RDA plot with text encased in labels
plotRDA(tse, "RDA",
        colour_by = "ClinicalStatus",
        vec_text = FALSE)
 
# Create RDA plot without repelling text
plotRDA(tse, "RDA",
        colour_by = "ClinicalStatus",
        repel_labels = FALSE)
 
# Calculate RDA as a separate object
rda_mat <- calculateRDA(tse,
                        formula = assay ~ ClinicalStatus + Gender + Age,
                        FUN = vegan::vegdist,
                        distance = "bray")
 
# Create RDA plot from RDA matrix
plotRDA(rda_mat)
}
