% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotPrevalence.R
\name{plotPrevalence}
\alias{plotPrevalence}
\alias{plotPrevalence,SummarizedExperiment-method}
\alias{plotPrevalentAbundance}
\alias{plotPrevalentAbundance,SummarizedExperiment-method}
\alias{plotFeaturePrevalence}
\alias{plotTaxaPrevalence}
\alias{plotFeaturePrevalence,SummarizedExperiment-method}
\alias{plotTaxaPrevalence,ANY-method}
\title{Plot prevalence information}
\usage{
plotPrevalence(x, ...)

\S4method{plotPrevalence}{SummarizedExperiment}(
  x,
  detections = c(0.01, 0.1, 1, 2, 5, 10, 20)/100,
  prevalences = seq(0.1, 1, 0.1),
  assay.type = assay_name,
  assay_name = "counts",
  as.relative = TRUE,
  rank = NULL,
  BPPARAM = BiocParallel::SerialParam(),
  ...
)

plotPrevalentAbundance(x, ...)

\S4method{plotPrevalentAbundance}{SummarizedExperiment}(
  x,
  rank = taxonomyRanks(x)[1L],
  assay.type = assay_name,
  assay_name = "counts",
  as.relative = TRUE,
  colur.by = NULL,
  size.by = size_by,
  size_by = NULL,
  shape.by = shape_by,
  shape_by = NULL,
  label = NULL,
  facet.by = facet_by,
  facet_by = NULL,
  ...
)

plotFeaturePrevalence(x, ...)

\S4method{plotFeaturePrevalence}{SummarizedExperiment}(
  x,
  rank = taxonomyRanks(x)[1L],
  assay.type = assay_name,
  assay_name = "counts",
  detections = NULL,
  ndetections = 20,
  as.relative = TRUE,
  min.prevalence = min_prevalence,
  min_prevalence = 0,
  BPPARAM = BiocParallel::SerialParam(),
  ...
)

plotTaxaPrevalence(x, ...)

\S4method{plotTaxaPrevalence}{ANY}(x, ...)
}
\arguments{
\item{x}{a
\code{\link[SummarizedExperiment:SummarizedExperiment-class]{SummarizedExperiment}}
object.}

\item{detections}{Detection thresholds for absence/presence. Either an
absolutes value compared directly to the values of \code{x} or a relative
value between 0 and 1, if \code{as.relative = TRUE}.}

\item{prevalences}{Prevalence thresholds (in 0 to 1). The
required prevalence is strictly greater by default. To include the
limit, set \code{include_lowest} to \code{TRUE}.}

\item{assay.type}{a \code{character} value defining which assay data to
use. (default: \code{assay.type = "relabundance"})}

\item{assay_name}{a single \code{character} value for specifying which
assay to use for calculation.
(Please use \code{assay.type} instead. At some point \code{assay_name}
will be disabled.)}

\item{as.relative}{logical scalar: Should the detection threshold be applied
on compositional (relative) abundances? Passed onto
\code{\link[mia:getPrevalence]{getPrevalence}}. (default: \code{TRUE})}

\item{rank, ...}{additional arguments
\itemize{
\item{If \code{!is.null(rank)} matching arguments are passed on to
\code{\link[=agglomerate-methods]{agglomerateByRank}}. See
\code{\link[=agglomerate-methods]{?agglomerateByRank}} for more details.
}
\item{additional arguments for plotting. See
\code{\link{mia-plot-args}} for more details i.e. call \code{help("mia-plot-args")}}
}}

\item{BPPARAM}{A
\code{\link[BiocParallel:BiocParallelParam-class]{BiocParallelParam}}
object specifying whether the UniFrac calculation should be parallelized.}

\item{colur.by}{Specification of a feature to colour points by, see the
\code{by} argument in
\code{\link[scater:retrieveFeatureInfo]{?retrieveFeatureInfo}} for
possible values. Only used with \code{layout = "point"}.}

\item{size.by}{Specification of a feature to size points by, see the
\code{by} argument in
\code{\link[scater:retrieveFeatureInfo]{?retrieveFeatureInfo}} for
possible values. Only used with \code{layout = "point"}.}

\item{size_by}{Deprecated. Use \cod{size.by} instead.}

\item{shape.by}{Specification of a feature to shape points by, see the
\code{by} argument in
\code{\link[scater:retrieveFeatureInfo]{?retrieveFeatureInfo}} for
possible values. Only used with \code{layout = "point"}.}

\item{shape_by}{Deprecated. Use \code{shape.by} instead.}

\item{label}{a \code{logical}, \code{character} or \code{integer} vector
for selecting labels from the rownames of \code{x}. If \code{rank} is not
\code{NULL} the rownames might change. (default: \code{label = NULL})}

\item{facet.by}{Taxonomic rank to facet the plot by.
Value must be of \code{taxonomyRanks(x)}
Argument can only be used in function plotPrevalentAbundance.}

\item{facet_by}{Deprecated. Use \code{facet.by} instead.}

\item{ndetections}{If \code{detections} is \code{NULL}, a number of breaks
are calculated automatically. \code{as.relative} is then also regarded as
\code{TRUE}.}

\item{min.prevalence}{a single numeric value to apply as a threshold for
plotting. The threshold is applied per row and column.
(default: \code{min.prevalence = 0})}

\item{min_prevalence}{Deprecated. Use \code{min.prevalence} instead.}

\item{colour_by}{Deprecated. Use \code{colour.by} instead.}
}
\value{
A \code{ggplot2} object or \code{plotly} object, if more than one
\code{prevalences} was defined.
}
\description{
\code{plotPrevalence} and \code{plotFeaturePrevalence} visualize prevalence
information.
}
\details{
Whereas \code{plotPrevalence} produces a line plot, \code{plotFeaturePrevalence}
returns a heatmap.

Agglomeration on different taxonomic levels is available through the
\code{rank} argument.

To exclude certain taxa, preprocess \code{x} to your liking, for example
with subsetting via \code{getPrevalentTaxa} or
\code{agglomerateByPrevalence}.
}
\examples{
data(GlobalPatterns, package = "mia")

# plotting N of prevalence exceeding taxa on the Phylum level
plotPrevalence(GlobalPatterns, rank = "Phylum")
plotPrevalence(GlobalPatterns, rank = "Phylum") + scale_x_log10()

# plotting prevalence per taxa for different detection thresholds as heatmap
plotFeaturePrevalence(GlobalPatterns, rank = "Phylum")

# by default a continuous scale is used for different detection levels, 
# but this can be adjusted
plotFeaturePrevalence(GlobalPatterns, rank = "Phylum",
                   detections = c(0, 0.001, 0.01, 0.1, 0.2))
                   
# point layout for plotFeaturePrevalence can be used to visualize by additional
# information
plotPrevalentAbundance(GlobalPatterns, rank = "Family",
                       colur.by = "Phylum") +
    scale_x_log10()

# When using function plotPrevalentAbundace, it is possible to create facets
# with 'facet.by'.
plotPrevalentAbundance(GlobalPatterns, rank = "Family",
                       colur.by = "Phylum", facet.by = "Kingdom") +
    scale_x_log10()
}
\seealso{
\code{\link[mia:getPrevalence]{getPrevalence}},
\code{\link[mia:getPrevalence]{agglomerateByPrevalence}},
\code{\link[mia:agglomerate-methods]{agglomerateByRank}}
}
