% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotPrevalence.R
\name{plotPrevalence}
\alias{plotPrevalence}
\alias{plotPrevalence,SummarizedExperiment-method}
\alias{plotPrevalentAbundance}
\alias{plotPrevalentAbundance,SummarizedExperiment-method}
\alias{plotRowPrevalence}
\alias{plotTaxaPrevalence}
\alias{plotRowPrevalence,SummarizedExperiment-method}
\alias{plotTaxaPrevalence,ANY-method}
\alias{plotFeaturePrevalence}
\alias{plotFeaturePrevalence,ANY-method}
\title{Plot prevalence information}
\usage{
plotPrevalence(x, ...)

\S4method{plotPrevalence}{SummarizedExperiment}(
  x,
  detection = detections,
  detections = c(0.01, 0.1, 1, 2, 5, 10, 20),
  prevalence = prevalences,
  prevalences = seq(0.1, 1, 0.1),
  assay.type = assay_name,
  assay_name = "counts",
  rank = NULL,
  BPPARAM = BiocParallel::SerialParam(),
  ...
)

plotPrevalentAbundance(x, ...)

\S4method{plotPrevalentAbundance}{SummarizedExperiment}(
  x,
  rank = NULL,
  assay.type = assay_name,
  assay_name = "counts",
  colour_by = NULL,
  size_by = NULL,
  shape_by = NULL,
  label = NULL,
  facet_by = NULL,
  ...
)

plotRowPrevalence(x, ...)

\S4method{plotRowPrevalence}{SummarizedExperiment}(
  x,
  rank = NULL,
  assay.type = assay_name,
  assay_name = "counts",
  detection = detections,
  detections = c(0.01, 0.1, 1, 2, 5, 10, 20),
  ndetection = 20,
  min_prevalence = 0,
  BPPARAM = BiocParallel::SerialParam(),
  ...
)

plotTaxaPrevalence(x, ...)

\S4method{plotTaxaPrevalence}{ANY}(x, ...)

plotFeaturePrevalence(x, ...)

\S4method{plotFeaturePrevalence}{ANY}(x, ...)
}
\arguments{
\item{x}{a
\code{\link[SummarizedExperiment:SummarizedExperiment-class]{SummarizedExperiment}}
object.}

\item{detection}{Detection thresholds for absence/presence. Either an
absolutes value compared directly to the values of \code{x} or a relative
value between 0 and 1, if \code{as_relative = TRUE}.}

\item{detections}{Deprecated. Use \code{detection} instead.}

\item{prevalence}{Prevalence thresholds (in 0 to 1). The
required prevalence is strictly greater by default. To include the
limit, set \code{include_lowest} to \code{TRUE}.}

\item{prevalences}{Deprecated. Use \code{prevalence} instead.}

\item{assay.type}{a \code{character} value defining which assay data to
use. (default: \code{assay.type = "relabundance"})}

\item{assay_name}{a single \code{character} value for specifying which
assay to use for calculation.
(Please use \code{assay.type} instead. At some point \code{assay_name}
will be disabled.)}

\item{rank, ...}{additional arguments
\itemize{
\item{use_relative}{ \code{TRUE} or \code{FALSE}: Should the relative values
be calculated? (Default: \code{FALSE}) }

\item{If \code{!is.null(rank)} matching arguments are passed on to
\code{\link[=agglomerate-methods]{agglomerateByRank}}. See
\code{\link[=agglomerate-methods]{?agglomerateByRank}} for more details.
}

\item{additional arguments for plotting. See
\code{\link{mia-plot-args}} for more details i.e. call
\code{help("mia-plot-args")}}
}}

\item{BPPARAM}{A
\code{\link[BiocParallel:BiocParallelParam-class]{BiocParallelParam}}
object specifying whether the UniFrac calculation should be parallelized.}

\item{colour_by}{Specification of a feature to colour points by, see the
\code{by} argument in
\code{\link[scater:retrieveFeatureInfo]{?retrieveFeatureInfo}} for
possible values. Only used with \code{layout = "point"}.}

\item{size_by}{Specification of a feature to size points by, see the
\code{by} argument in
\code{\link[scater:retrieveFeatureInfo]{?retrieveFeatureInfo}} for
possible values. Only used with \code{layout = "point"}.}

\item{shape_by}{Specification of a feature to shape points by, see the
\code{by} argument in
\code{\link[scater:retrieveFeatureInfo]{?retrieveFeatureInfo}} for
possible values. Only used with \code{layout = "point"}.}

\item{label}{a \code{logical}, \code{character} or \code{integer} vector
for selecting labels from the rownames of \code{x}. If \code{rank} is not
\code{NULL} the rownames might change. (default: \code{label = NULL})}

\item{facet_by}{Taxonomic rank to facet the plot by.
Value must be of \code{taxonomyRanks(x)}
Argument can only be used in function plotPrevalentAbundance.}

\item{ndetection}{If \code{detection} is \code{NULL}, a number of breaks
are calculated automatically. \code{as_relative} is then also regarded as
\code{TRUE}.}

\item{min_prevalence}{a single numeric value to apply as a threshold for
plotting. The threshold is applied per row and column.
(default: \code{min_prevalence = 0})}
}
\value{
A \code{ggplot2} object or \code{plotly} object, if more than one
\code{prevalence} was defined.
}
\description{
\code{plotPrevalence} and \code{plotRowPrevalence} visualize prevalence
information.
}
\details{
Whereas \code{plotPrevalence} produces a line plot, \code{plotRowPrevalence}
returns a heatmap.

Agglomeration on different taxonomic levels is available through the
\code{rank} argument.

To exclude certain taxa, preprocess \code{x} to your liking, for example
with subsetting via \code{getPrevalent} or
\code{agglomerateByPrevalence}.
}
\examples{
data(GlobalPatterns, package = "mia")

# Apply relative transformation
GlobalPatterns <- transformAssay(GlobalPatterns, method = "relabundance")

# plotting N of prevalence exceeding taxa on the Phylum level
plotPrevalence(GlobalPatterns, rank = "Phylum")
plotPrevalence(GlobalPatterns, rank = "Phylum") + scale_x_log10()

# plotting prevalence per taxa for different detection thresholds as heatmap
plotRowPrevalence(GlobalPatterns, rank = "Phylum")

# by default a continuous scale is used for different detection levels, 
# but this can be adjusted
plotRowPrevalence(
    GlobalPatterns, rank = "Phylum", assay.type = "relabundance",
    detection = c(0, 0.001, 0.01, 0.1, 0.2))
                   
# point layout for plotRowPrevalence can be used to visualize by additional
# information
plotPrevalentAbundance(
    GlobalPatterns, rank = "Family", colour_by = "Phylum") +
    scale_x_log10()

# When using function plotPrevalentAbundace, it is possible to create facets
# with 'facet_by'.
plotPrevalentAbundance(
    GlobalPatterns, rank = "Family",
    colour_by = "Phylum", facet_by = "Kingdom") +
    scale_x_log10()
}
\seealso{
\code{\link[mia:getPrevalence]{getPrevalence}},
\code{\link[mia:getPrevalence]{agglomerateByPrevalence}},
\code{\link[mia:agglomerate-methods]{agglomerateByRank}}
}
