<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot RDA or CCA object — plotCCA • miaViz</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot RDA or CCA object — plotCCA"><meta property="og:description" content="plotRDA and plotCCA create an RDA/CCA plot starting from the
output of CCA and RDA functions, two common methods
for supervised ordination of microbiome data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">miaViz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.13.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/miaViz.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot RDA or CCA object</h1>

    <div class="hidden name"><code>plotCCA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>plotRDA</code> and <code>plotCCA</code> create an RDA/CCA plot starting from the
output of <code><a href="https://rdrr.io/pkg/mia/man/runCCA.html" class="external-link">CCA and RDA</a></code> functions, two common methods
for supervised ordination of microbiome data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotCCA</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SingleCellExperiment'</span></span>
<span><span class="fu">plotCCA</span><span class="op">(</span><span class="va">object</span>, <span class="va">dimred</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'matrix'</span></span>
<span><span class="fu">plotCCA</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plotRDA</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SingleCellExperiment'</span></span>
<span><span class="fu">plotRDA</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">dimred</span>,</span>
<span>  add.ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ellipse.alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  ellipse.linewidth <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  ellipse.linetype <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  confidence.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  vec.size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  vec.color <span class="op">=</span> <span class="va">vec.colour</span>,</span>
<span>  vec.colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  vec.linetype <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  arrow.size <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  label.color <span class="op">=</span> <span class="va">label.colour</span>,</span>
<span>  label.colour <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  label.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  vec.text <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  repel.labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sep.group <span class="op">=</span> <span class="st">"—"</span>,</span>
<span>  repl.underscore <span class="op">=</span> <span class="st">" "</span>,</span>
<span>  add.significance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add.expl.var <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add.vectors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parse.labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'matrix'</span></span>
<span><span class="fu">plotRDA</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a
<code><a href="https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-constructor.html" class="external-link">TreeSummarizedExperiment</a></code>
or a matrix of weights. The latter is returned as output from <code><a href="https://rdrr.io/pkg/mia/man/runCCA.html" class="external-link">getRDA</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters for plotting, inherited from
<code><a href="https://rdrr.io/pkg/scater/man/plotReducedDim.html" class="external-link">plotReducedDim</a></code>,
<code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></code> and
<code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></code>.</p></dd>


<dt id="arg-dimred">dimred<a class="anchor" aria-label="anchor" href="#arg-dimred"></a></dt>
<dd><p>A string or integer scalar indicating the reduced dimension to
plot. This is the output of <code><a href="https://rdrr.io/pkg/mia/man/runCCA.html" class="external-link">addRDA</a></code> and resides in
<code>reducedDim(tse, dimred)</code>.</p></dd>


<dt id="arg-add-ellipse">add.ellipse<a class="anchor" aria-label="anchor" href="#arg-add-ellipse"></a></dt>
<dd><p>One of <code>c(TRUE, FALSE, "fill", "colour", "color")</code>,
indicating whether ellipses should be present, absent, filled or colored.
(default: <code>ellipse.fill = TRUE</code>)</p></dd>


<dt id="arg-ellipse-alpha">ellipse.alpha<a class="anchor" aria-label="anchor" href="#arg-ellipse-alpha"></a></dt>
<dd><p>Number between 0 and 1 to adjust the opacity of ellipses.
(default: <code>ellipse.alpha = 0.2</code>)</p></dd>


<dt id="arg-ellipse-linewidth">ellipse.linewidth<a class="anchor" aria-label="anchor" href="#arg-ellipse-linewidth"></a></dt>
<dd><p>Number specifying the size of ellipses.
(default: <code>ellipse.linewidth = 0.1</code>)</p></dd>


<dt id="arg-ellipse-linetype">ellipse.linetype<a class="anchor" aria-label="anchor" href="#arg-ellipse-linetype"></a></dt>
<dd><p>Discrete number specifying the style of ellipses.
(default: <code>ellipse.linetype = 1</code>)</p></dd>


<dt id="arg-confidence-level">confidence.level<a class="anchor" aria-label="anchor" href="#arg-confidence-level"></a></dt>
<dd><p>Number between 0 and 1 to adjust confidence level.
(default: <code>confidence.level = 0.95</code>)</p></dd>


<dt id="arg-vec-size">vec.size<a class="anchor" aria-label="anchor" href="#arg-vec-size"></a></dt>
<dd><p>Number specifying the size of vectors.
(default: <code>vec.size = 0.5</code>)</p></dd>


<dt id="arg-vec-color">vec.color<a class="anchor" aria-label="anchor" href="#arg-vec-color"></a></dt>
<dd><p>Alias for <code>vec.colour</code>.</p></dd>


<dt id="arg-vec-colour">vec.colour<a class="anchor" aria-label="anchor" href="#arg-vec-colour"></a></dt>
<dd><p>String specifying the colour of vectors.
(default: <code>vec.color = "black"</code>)</p></dd>


<dt id="arg-vec-linetype">vec.linetype<a class="anchor" aria-label="anchor" href="#arg-vec-linetype"></a></dt>
<dd><p>Discrete number specifying the style of vector lines.
(default: <code>vec.linetype = 1</code>)</p></dd>


<dt id="arg-arrow-size">arrow.size<a class="anchor" aria-label="anchor" href="#arg-arrow-size"></a></dt>
<dd><p>Number specifying the size of arrows.
(defaults: <code>arrow.size = 0.25</code>)</p></dd>


<dt id="arg-label-color">label.color<a class="anchor" aria-label="anchor" href="#arg-label-color"></a></dt>
<dd><p>Alias for <code>label.colour</code>.</p></dd>


<dt id="arg-label-colour">label.colour<a class="anchor" aria-label="anchor" href="#arg-label-colour"></a></dt>
<dd><p>String specifying the colour of text and labels.
(default: <code>label.color = "black"</code>)</p></dd>


<dt id="arg-label-size">label.size<a class="anchor" aria-label="anchor" href="#arg-label-size"></a></dt>
<dd><p>Number specifying the size of text and labels.
(default: <code>label.size = 4</code>)</p></dd>


<dt id="arg-vec-text">vec.text<a class="anchor" aria-label="anchor" href="#arg-vec-text"></a></dt>
<dd><p>TRUE or FALSE, should text instead of labels be used to label vectors.
(default: <code>vec.text = TRUE</code>)</p></dd>


<dt id="arg-repel-labels">repel.labels<a class="anchor" aria-label="anchor" href="#arg-repel-labels"></a></dt>
<dd><p>TRUE or FALSE, should labels be repelled.
(default: <code>repel.labels = TRUE</code>)</p></dd>


<dt id="arg-sep-group">sep.group<a class="anchor" aria-label="anchor" href="#arg-sep-group"></a></dt>
<dd><p>String specifying the separator used in the labels.
(default: <code>sep.group = "\U2014"</code>)</p></dd>


<dt id="arg-repl-underscore">repl.underscore<a class="anchor" aria-label="anchor" href="#arg-repl-underscore"></a></dt>
<dd><p>String used to replace underscores in the labels.
(default: <code>repl.underscore = " "</code>)</p></dd>


<dt id="arg-add-significance">add.significance<a class="anchor" aria-label="anchor" href="#arg-add-significance"></a></dt>
<dd><p>TRUE or FALSE, should explained variance and p-value
appear in the labels. (default: <code>add.significance = TRUE</code>)</p></dd>


<dt id="arg-add-expl-var">add.expl.var<a class="anchor" aria-label="anchor" href="#arg-add-expl-var"></a></dt>
<dd><p>TRUE or FALSE, should explained variance appear on the
coordinate axes. (default: <code>add.expl.var = TRUE</code>)</p></dd>


<dt id="arg-add-vectors">add.vectors<a class="anchor" aria-label="anchor" href="#arg-add-vectors"></a></dt>
<dd><p>TRUE or FALSE, should vectors appear in the plot.
(default: <code>add.vectors = TRUE</code>)</p></dd>


<dt id="arg-parse-labels">parse.labels<a class="anchor" aria-label="anchor" href="#arg-parse-labels"></a></dt>
<dd><p>TRUE or FALSE, should labels be parsed.
(default: <code>parse.labels = TRUE</code>)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>ggplot2</code> object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>plotRDA</code> and <code>plotCCA</code> create an RDA/CCA plot starting from the
output of <code><a href="https://rdrr.io/pkg/mia/man/runCCA.html" class="external-link">CCA and RDA</a></code> functions, two common methods
for supervised ordination of microbiome data. Either a
<code><a href="https://rdrr.io/pkg/TreeSummarizedExperiment/man/TreeSummarizedExperiment-constructor.html" class="external-link">TreeSummarizedExperiment</a></code>
or a matrix object is supported as input. When the input is a
TreeSummarizedExperiment, this should contain the output of addRDA
in the reducedDim slot and the argument <code>dimred</code> needs to be defined.
When the input is a matrix, this should be returned as output from
getRDA. However, the first method is recommended because it provides
the option to adjust aesthetics to the colData variables through the
arguments inherited from <code><a href="https://rdrr.io/pkg/scater/man/plotReducedDim.html" class="external-link">plotReducedDim</a></code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load dataset</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">miaViz</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"enterotype"</span>, package <span class="op">=</span> <span class="st">"mia"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="va">enterotype</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Run RDA and store results into TreeSE</span></span></span>
<span class="r-in"><span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/runCCA.html" class="external-link">addRDA</a></span><span class="op">(</span><span class="va">tse</span>,</span></span>
<span class="r-in"><span>              formula <span class="op">=</span> <span class="va">assay</span> <span class="op">~</span> <span class="va">ClinicalStatus</span> <span class="op">+</span> <span class="va">Gender</span> <span class="op">+</span> <span class="va">Age</span>,</span></span>
<span class="r-in"><span>              FUN <span class="op">=</span> <span class="fu">vegan</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span>,</span></span>
<span class="r-in"><span>              distance <span class="op">=</span> <span class="st">"bray"</span>,</span></span>
<span class="r-in"><span>              na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span></span>
<span class="r-in"><span>               </span></span>
<span class="r-in"><span><span class="co"># Create RDA plot coloured by variable</span></span></span>
<span class="r-in"><span><span class="fu">plotRDA</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"RDA"</span>,</span></span>
<span class="r-in"><span>        colour_by <span class="op">=</span> <span class="st">"ClinicalStatus"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_ellipse()`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-plt img"><img src="plotCCA-1.png" alt="" width="3000" height="2100"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Create RDA plot with empty ellipses</span></span></span>
<span class="r-in"><span><span class="fu">plotRDA</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"RDA"</span>,</span></span>
<span class="r-in"><span>        colour_by <span class="op">=</span> <span class="st">"ClinicalStatus"</span>,</span></span>
<span class="r-in"><span>        add.ellipse <span class="op">=</span> <span class="st">"colour"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_ellipse()`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-plt img"><img src="plotCCA-2.png" alt="" width="3000" height="2100"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Create RDA plot with text encased in labels</span></span></span>
<span class="r-in"><span><span class="fu">plotRDA</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"RDA"</span>,</span></span>
<span class="r-in"><span>        colour_by <span class="op">=</span> <span class="st">"ClinicalStatus"</span>,</span></span>
<span class="r-in"><span>        vec.text <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_ellipse()`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-plt img"><img src="plotCCA-3.png" alt="" width="3000" height="2100"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Create RDA plot without repelling text</span></span></span>
<span class="r-in"><span><span class="fu">plotRDA</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"RDA"</span>,</span></span>
<span class="r-in"><span>        colour_by <span class="op">=</span> <span class="st">"ClinicalStatus"</span>,</span></span>
<span class="r-in"><span>        repel.labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_ellipse()`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-plt img"><img src="plotCCA-4.png" alt="" width="3000" height="2100"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Create RDA plot without vectors</span></span></span>
<span class="r-in"><span><span class="fu">plotRDA</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"RDA"</span>,</span></span>
<span class="r-in"><span>        colour_by <span class="op">=</span> <span class="st">"ClinicalStatus"</span>,</span></span>
<span class="r-in"><span>        add.vectors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>'add.vectors' is FALSE, so other arguments for vectors and labels will be disregarded.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_ellipse()`).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Too few points to calculate an ellipse</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 243 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-plt img"><img src="plotCCA-5.png" alt="" width="3000" height="2100"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Calculate RDA as a separate object</span></span></span>
<span class="r-in"><span><span class="va">rda_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mia/man/runCCA.html" class="external-link">getRDA</a></span><span class="op">(</span><span class="va">tse</span>,</span></span>
<span class="r-in"><span>                  formula <span class="op">=</span> <span class="va">assay</span> <span class="op">~</span> <span class="va">ClinicalStatus</span> <span class="op">+</span> <span class="va">Gender</span> <span class="op">+</span> <span class="va">Age</span>,</span></span>
<span class="r-in"><span>                  FUN <span class="op">=</span> <span class="fu">vegan</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html" class="external-link">vegdist</a></span>,</span></span>
<span class="r-in"><span>                  distance <span class="op">=</span> <span class="st">"bray"</span>,</span></span>
<span class="r-in"><span>                  na.action <span class="op">=</span> <span class="va">na.exclude</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Create RDA plot from RDA matrix</span></span></span>
<span class="r-in"><span><span class="fu">plotRDA</span><span class="op">(</span><span class="va">rda_mat</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotCCA-6.png" alt="" width="3000" height="2100"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tuomas Borman, Felix G.M. Ernst, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

